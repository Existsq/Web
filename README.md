Лабораторная работа №2

Цель работы

Разработка структуры базы данных и подключение её к бэкенду.

⸻

Порядок демонстрации
1.	Админка: показать панель администратора Django или Adminer, в которой добавляется новая услуга.
2.	База данных: выполнить SELECT и проверить данные.
3.	Приложение: показать три страницы:
•	поиск услуг,
•	удаление заявки,
•	переход по URL удалённой заявки.
4.	Заявка: добавить две услуги, показать изменение карточки “корзины”, просмотреть содержимое.
5.	SQL и ORM:
•	показать результаты логического удаления заявки и добавление новой,
•	изменить поля в БД и отразить изменения в приложении,
•	показать модели, составной уникальный ключ м-м,
•	реализовать 4 контроллера через ORM,
•	удаление заявки выполнить через SQL UPDATE (без ORM).

⸻

Контрольные вопросы
•	Виды баз данных.
•	SQL-запросы.
•	Курсоры.
•	ORM.
•	Модели и миграции.
•	Чистая архитектура.

⸻

ER-диаграмма
•	Построить в StarUML.
•	Указать таблицы, связи, столбцы, их типы и длины.
•	Определить первичные и внешние ключи.

⸻

Задание

Создать базу данных PostgreSQL по теме работы и подключить её к трём шаблонам приложения.

Необходимо:
•	разработать структуру БД с учётом требований,
•	использовать таблицу услуг на страницах приложения,
•	наполнить таблицы данными через Django Admin или Adminer.

⸻

Функциональность приложения
•	Получение и поиск услуг.
•	Добавление услуги в текущую заявку (черновик = корзина) через ORM.
•	Просмотр текущей заявки.
•	Логическое удаление заявки (смена статуса на удалён) через SQL UPDATE (без ORM).

HTTP-методы:
•	3 × GET,
•	1 × POST (добавление в заявку через ORM),
•	1 × POST (удаление заявки через SQL).

Правила работы с заявками:
•	Если у пользователя нет заявки в статусе черновик, она создаётся при добавлении первой услуги.
•	Если заявка уже существует, услуга добавляется в неё.
•	Удалённые заявки нельзя просматривать.
•	Если заявки нет, карточка на странице услуг не активна.

⸻

Требования к БД

Минимум 4 таблицы (каскадное удаление запрещено!):
1.	Услуги
•	наименование,
•	описание,
•	статус (удалён/действует),
•	URL изображения (Nullable),
•	предметные поля.
2.	Заявки
•	обязательные поля: id, статус, дата создания (datetime), создатель,
•	дополнительные: дата формирования, дата завершения, модератор,
•	предметные поля.
3.	Связь заявка–услуга (м-м)
•	составной уникальный ключ,
•	дополнительные поля: количество, порядок, главный, другое.
4.	Пользователи
•	использовать системную таблицу Django (логин, пароль, признак модератора).

Особенности:
•	не менее 5 статусов заявок: черновик, удалён, сформирован, завершён, отклонён,
•	у каждого пользователя не более одной заявки в статусе черновик,
•	одно из дополнительных полей заявки или связи м-м должно вычисляться при завершении заявки.
