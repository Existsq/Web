package com.bmstu.lab.repository.category;

import com.bmstu.lab.exception.NotFoundException;
import com.bmstu.lab.model.Category;
import java.util.List;
import java.util.Locale;
import java.util.Map;
import org.springframework.stereotype.Component;

@Component
public class InMemoryCategoryRepository implements CategoryRepository {

  private final List<Category> categoryStorage =
      List.of(
          new Category(
              1L,
              "Продукты питания",
              28000,
              1L,
              "Продукты питания составляют основную часть бюджета семьи. В эту категорию входят ежедневные покупки: мясо, рыба, молочные продукты, овощи, фрукты, хлеб, крупы и напитки. Рост цен на продукты моментально отражается на уровне жизни, так как отказаться от этой статьи расходов невозможно. Продукты питания формируют базовую корзину, от которой зависит расчет персонального индекса инфляции.",
              "Основные расходы семьи на еду"),
          new Category(
              2L,
              "ЖКХ",
              12000,
              2L,
              "Жилищно-коммунальные услуги включают оплату электричества, газа, воды, отопления и вывоза мусора. Это обязательные расходы, которые не зависят от уровня доходов семьи и требуют регулярной оплаты. В условиях сезонных изменений, например, в отопительный период, затраты могут значительно возрастать. Повышение тарифов на коммунальные услуги напрямую влияет на инфляцию и уровень доступного дохода населения.",
              "Коммунальные платежи за жильё"),
          new Category(
              3L,
              "Транспорт",
              10000,
              3L,
              "Расходы на транспорт включают покупку топлива, оплату общественного транспорта, парковок, а также техническое обслуживание автомобилей. Для жителей крупных городов эта статья расходов играет ключевую роль, так как напрямую влияет на мобильность. Колебания цен на бензин и дизельное топливо отражаются на конечных ценах товаров и услуг. Таким образом, транспортная категория оказывает значительное влияние на расчёт персонального индекса инфляции.",
              "Бензин, транспорт, парковки"),
          new Category(
              4L,
              "Связь и интернет",
              2500,
              4L,
              "Современная жизнь невозможна без мобильной связи и доступа в интернет. В категорию входят расходы на тарифные планы мобильных операторов, домашний интернет, а также подписки на онлайн-сервисы: видео, музыка, облачные хранилища. Несмотря на относительно небольшую долю в бюджете, эта категория является социальной необходимостью. Удорожание связи и интернет-услуг снижает доступность цифровых сервисов для населения.",
              "Расходы на связь и интернет"),
          new Category(
              5L,
              "Одежда и обувь",
              6000,
              5L,
              "Категория включает расходы на сезонные покупки одежды, обуви и аксессуаров. Сюда входят базовые предметы гардероба, верхняя одежда и спортивная форма. Для семей с детьми эта статья расходов особенно важна, так как одежду приходится обновлять регулярно. Изменение цен на одежду и обувь влияет на потребительские привычки и может привести к увеличению или сокращению доли расходов в других категориях.",
              "Сезонные траты на гардероб"),
          new Category(
              6L,
              "Здравоохранение",
              5000,
              6L,
              "Медицинские расходы охватывают посещение врачей, покупку лекарств, оплату анализов и профилактических мероприятий. Даже при наличии бесплатной медицины часть услуг оплачивается самостоятельно: стоматология, диагностика, витамины и медицинские препараты. Эта категория считается чувствительной, так как напрямую связана с качеством и продолжительностью жизни. Рост цен на медицинские услуги оказывает сильное влияние на ощущение личной инфляции.",
              "Расходы на здоровье и медицину"),
          new Category(
              7L,
              "Образование и досуг",
              4000,
              7L,
              "В категорию входят расходы на книги, кружки, секции, фитнес, кино и культурные мероприятия. Современные семьи также активно используют онлайн-образовательные платформы и курсы. Эта статья расходов отражает стремление к саморазвитию и поддержанию качества жизни. Хотя досуг не относится к обязательным тратам, он играет важную роль в расчёте персонального индекса, так как при сокращении доходов обычно урезается в первую очередь.",
              "Книги, кружки, развлечения"),
          new Category(
              8L,
              "Кафе и рестораны",
              7000,
              8L,
              "Расходы на кафе, рестораны и доставку еды становятся все более популярными в городах. Эта категория отражает уровень доступного дохода и образ жизни семьи. В периоды роста цен на продукты и услуги общепита, многие семьи снижают частоту посещения заведений или переходят на более доступные варианты. Таким образом, данная статья расходов чувствительна к экономической ситуации и отражает изменения в уровне потребления.",
              "Походы в кафе и доставка еды"));

  @Override
  public List<Category> findAll() {
    return categoryStorage;
  }

  @Override
  public List<Category> findByTitle(String title) {
    return categoryStorage.stream()
        .filter(
            category ->
                category
                    .title()
                    .toLowerCase(Locale.ROOT)
                    .startsWith(title.toLowerCase(Locale.ROOT)))
        .toList();
  }

  @Override
  public Category findById(Long id) {
    return categoryStorage.stream()
        .filter(category -> category.id().equals(id))
        .findFirst()
        .orElseThrow(() -> new NotFoundException("Категория с id=" + id + "не найдена"));
  }
}
